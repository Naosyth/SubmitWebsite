$("#form-error").html("");

annots = [
  <% @comments.each do |c| %>
    <% comment = raw '{row: ' + (c.line - 1).to_s + ', text: "'%>
    <% comment = comment + c.contents.gsub(/(?:\n\r?|\r\n?)/, '\n')%>
    <% comment = comment + raw( '", type: "error" , id:' + c.id.to_s + '}' )%>
    <%= comment %>
    <% if c != @comments.last %>
      <%= ',' %>
    <% end %> 
  <% end %>
];
editor = ace.edit("editor");
editor.session.setAnnotations(annots); 

$('#comment-list').html("<%= j (render @comments) %>");
